.include "macro.inc"

/* assembler directives */
.set noat      /* allow manual use of $at */
.set noreorder /* don't insert nops after branches */
.set gp=64     /* allow use of 64-bit general purpose registers */

.section .text, "ax"

/* Generated by spimdisasm 1.11.1 */

glabel osCreateViManager
/* 40430 80065030 27BDFFD0 */  addiu     $sp, $sp, -0x30
/* 40434 80065034 AFB20020 */  sw        $s2, 0x20($sp)
/* 40438 80065038 3C128009 */  lui       $s2, %hi(__osViDevMgr)
/* 4043C 8006503C 265232A0 */  addiu     $s2, $s2, %lo(__osViDevMgr)
/* 40440 80065040 AFBF002C */  sw        $ra, 0x2C($sp)
/* 40444 80065044 AFB40028 */  sw        $s4, 0x28($sp)
/* 40448 80065048 AFB30024 */  sw        $s3, 0x24($sp)
/* 4044C 8006504C AFB1001C */  sw        $s1, 0x1C($sp)
/* 40450 80065050 AFB00018 */  sw        $s0, 0x18($sp)
/* 40454 80065054 8E420000 */  lw        $v0, 0x0($s2)
/* 40458 80065058 1440004B */  bnez      $v0, .LIQUE_80065188
/* 4045C 8006505C 0080A021 */   addu     $s4, $a0, $zero
/* 40460 80065060 0C019210 */  jal       __osTimerServicesInit
/* 40464 80065064 2413FFFF */   addiu    $s3, $zero, -0x1
/* 40468 80065068 3C11800B */  lui       $s1, %hi(viEventQueue)
/* 4046C 8006506C 2631E4C8 */  addiu     $s1, $s1, %lo(viEventQueue)
/* 40470 80065070 02202021 */  addu      $a0, $s1, $zero
/* 40474 80065074 3C05800B */  lui       $a1, %hi(viEventBuf)
/* 40478 80065078 24A5E4E0 */  addiu     $a1, $a1, %lo(viEventBuf)
/* 4047C 8006507C 3C018009 */  lui       $at, %hi(__additional_scanline)
/* 40480 80065080 AC2032BC */  sw        $zero, %lo(__additional_scanline)($at)
/* 40484 80065084 0C018DB0 */  jal       osCreateMesgQueue
/* 40488 80065088 24060005 */   addiu    $a2, $zero, 0x5
/* 4048C 8006508C 24040007 */  addiu     $a0, $zero, 0x7
/* 40490 80065090 02202821 */  addu      $a1, $s1, $zero
/* 40494 80065094 3C02800B */  lui       $v0, %hi(viRetraceMsg)
/* 40498 80065098 2442E4F4 */  addiu     $v0, $v0, %lo(viRetraceMsg)
/* 4049C 8006509C 00403021 */  addu      $a2, $v0, $zero
/* 404A0 800650A0 2403000D */  addiu     $v1, $zero, 0xD
/* 404A4 800650A4 3C10800B */  lui       $s0, %hi(viCounterMsg)
/* 404A8 800650A8 2610E50C */  addiu     $s0, $s0, %lo(viCounterMsg)
/* 404AC 800650AC A4430000 */  sh        $v1, 0x0($v0)
/* 404B0 800650B0 2403000E */  addiu     $v1, $zero, 0xE
/* 404B4 800650B4 A0400002 */  sb        $zero, 0x2($v0)
/* 404B8 800650B8 AC400004 */  sw        $zero, 0x4($v0)
/* 404BC 800650BC A6030000 */  sh        $v1, 0x0($s0)
/* 404C0 800650C0 A2000002 */  sb        $zero, 0x2($s0)
/* 404C4 800650C4 0C018E84 */  jal       osSetEventMesg
/* 404C8 800650C8 AE000004 */   sw       $zero, 0x4($s0)
/* 404CC 800650CC 24040003 */  addiu     $a0, $zero, 0x3
/* 404D0 800650D0 02202821 */  addu      $a1, $s1, $zero
/* 404D4 800650D4 0C018E84 */  jal       osSetEventMesg
/* 404D8 800650D8 02003021 */   addu     $a2, $s0, $zero
/* 404DC 800650DC 0C01AE84 */  jal       osGetThreadPri
/* 404E0 800650E0 00002021 */   addu     $a0, $zero, $zero
/* 404E4 800650E4 0054182A */  slt       $v1, $v0, $s4
/* 404E8 800650E8 10600005 */  beqz      $v1, .LIQUE_80065100
/* 404EC 800650EC 00000000 */   nop
/* 404F0 800650F0 00409821 */  addu      $s3, $v0, $zero
/* 404F4 800650F4 00002021 */  addu      $a0, $zero, $zero
/* 404F8 800650F8 0C01905C */  jal       osSetThreadPri
/* 404FC 800650FC 02802821 */   addu     $a1, $s4, $zero
.LIQUE_80065100:
/* 40500 80065100 0C019B40 */  jal       __osDisableInt
/* 40504 80065104 00000000 */   nop
/* 40508 80065108 3C10800B */  lui       $s0, %hi(viThread)
/* 4050C 8006510C 2610D318 */  addiu     $s0, $s0, %lo(viThread)
/* 40510 80065110 02002021 */  addu      $a0, $s0, $zero
/* 40514 80065114 24050D49 */  addiu     $a1, $zero, 0xD49
/* 40518 80065118 3C068006 */  lui       $a2, %hi(viMgrMain)
/* 4051C 8006511C 24C651A8 */  addiu     $a2, $a2, %lo(viMgrMain)
/* 40520 80065120 24030001 */  addiu     $v1, $zero, 0x1
/* 40524 80065124 AE430000 */  sw        $v1, 0x0($s2)
/* 40528 80065128 3C03800B */  lui       $v1, %hi(viEventQueue)
/* 4052C 8006512C 2463E4C8 */  addiu     $v1, $v1, %lo(viEventQueue)
/* 40530 80065130 AE510008 */  sw        $s1, 0x8($s2)
/* 40534 80065134 AE51000C */  sw        $s1, 0xC($s2)
/* 40538 80065138 00408821 */  addu      $s1, $v0, $zero
/* 4053C 8006513C 02403821 */  addu      $a3, $s2, $zero
/* 40540 80065140 AE500004 */  sw        $s0, 0x4($s2)
/* 40544 80065144 AE400010 */  sw        $zero, 0x10($s2)
/* 40548 80065148 AE400014 */  sw        $zero, 0x14($s2)
/* 4054C 8006514C AE400018 */  sw        $zero, 0x18($s2)
/* 40550 80065150 AFA30010 */  sw        $v1, 0x10($sp)
/* 40554 80065154 0C019000 */  jal       osCreateThread
/* 40558 80065158 AFB40014 */   sw       $s4, 0x14($sp)
/* 4055C 8006515C 0C01AEC8 */  jal       __osViInit
/* 40560 80065160 00000000 */   nop
/* 40564 80065164 0C0190A0 */  jal       osStartThread
/* 40568 80065168 02002021 */   addu     $a0, $s0, $zero
/* 4056C 8006516C 0C019B5C */  jal       __osRestoreInt
/* 40570 80065170 02202021 */   addu     $a0, $s1, $zero
/* 40574 80065174 2402FFFF */  addiu     $v0, $zero, -0x1
/* 40578 80065178 12620003 */  beq       $s3, $v0, .LIQUE_80065188
/* 4057C 8006517C 00002021 */   addu     $a0, $zero, $zero
/* 40580 80065180 0C01905C */  jal       osSetThreadPri
/* 40584 80065184 02602821 */   addu     $a1, $s3, $zero
.LIQUE_80065188:
/* 40588 80065188 8FBF002C */  lw        $ra, 0x2C($sp)
/* 4058C 8006518C 8FB40028 */  lw        $s4, 0x28($sp)
/* 40590 80065190 8FB30024 */  lw        $s3, 0x24($sp)
/* 40594 80065194 8FB20020 */  lw        $s2, 0x20($sp)
/* 40598 80065198 8FB1001C */  lw        $s1, 0x1C($sp)
/* 4059C 8006519C 8FB00018 */  lw        $s0, 0x18($sp)
/* 405A0 800651A0 03E00008 */  jr        $ra
/* 405A4 800651A4 27BD0030 */   addiu    $sp, $sp, 0x30

glabel viMgrMain
/* 405A8 800651A8 27BDFFD0 */  addiu     $sp, $sp, -0x30
/* 405AC 800651AC AFB40028 */  sw        $s4, 0x28($sp)
/* 405B0 800651B0 0080A021 */  addu      $s4, $a0, $zero
/* 405B4 800651B4 AFBF002C */  sw        $ra, 0x2C($sp)
/* 405B8 800651B8 AFB30024 */  sw        $s3, 0x24($sp)
/* 405BC 800651BC AFB20020 */  sw        $s2, 0x20($sp)
/* 405C0 800651C0 AFB1001C */  sw        $s1, 0x1C($sp)
/* 405C4 800651C4 AFB00018 */  sw        $s0, 0x18($sp)
/* 405C8 800651C8 0C01AF08 */  jal       __osViGetCurrentContext
/* 405CC 800651CC AFA00010 */   sw       $zero, 0x10($sp)
/* 405D0 800651D0 94430002 */  lhu       $v1, 0x2($v0)
/* 405D4 800651D4 3C01800B */  lui       $at, %hi(retrace)
/* 405D8 800651D8 A423D310 */  sh        $v1, %lo(retrace)($at)
/* 405DC 800651DC 3063FFFF */  andi      $v1, $v1, 0xFFFF
/* 405E0 800651E0 14600004 */  bnez      $v1, .LIQUE_800651F4
/* 405E4 800651E4 00008821 */   addu     $s1, $zero, $zero
/* 405E8 800651E8 24020001 */  addiu     $v0, $zero, 0x1
/* 405EC 800651EC 3C01800B */  lui       $at, %hi(retrace)
/* 405F0 800651F0 A422D310 */  sh        $v0, %lo(retrace)($at)
.LIQUE_800651F4:
/* 405F4 800651F4 2413000D */  addiu     $s3, $zero, 0xD
/* 405F8 800651F8 2412000E */  addiu     $s2, $zero, 0xE
/* 405FC 800651FC 27A50010 */  addiu     $a1, $sp, 0x10
.LIQUE_80065200:
/* 40600 80065200 8E84000C */  lw        $a0, 0xC($s4)
.LIQUE_80065204:
/* 40604 80065204 0C018DCC */  jal       osRecvMesg
/* 40608 80065208 24060001 */   addiu    $a2, $zero, 0x1
/* 4060C 8006520C 8FA30010 */  lw        $v1, 0x10($sp)
/* 40610 80065210 94620000 */  lhu       $v0, 0x0($v1)
/* 40614 80065214 10530005 */  beq       $v0, $s3, .LIQUE_8006522C
/* 40618 80065218 00000000 */   nop
/* 4061C 8006521C 10520040 */  beq       $v0, $s2, .LIQUE_80065320
/* 40620 80065220 27A50010 */   addiu    $a1, $sp, 0x10
/* 40624 80065224 08019481 */  j         .LIQUE_80065204
/* 40628 80065228 8E84000C */   lw       $a0, 0xC($s4)
.LIQUE_8006522C:
/* 4062C 8006522C 0C01958C */  jal       __osViSwapContext
/* 40630 80065230 00000000 */   nop
/* 40634 80065234 3C02800B */  lui       $v0, %hi(retrace)
/* 40638 80065238 9442D310 */  lhu       $v0, %lo(retrace)($v0)
/* 4063C 8006523C 2442FFFF */  addiu     $v0, $v0, -0x1
/* 40640 80065240 3C01800B */  lui       $at, %hi(retrace)
/* 40644 80065244 A422D310 */  sh        $v0, %lo(retrace)($at)
/* 40648 80065248 3042FFFF */  andi      $v0, $v0, 0xFFFF
/* 4064C 8006524C 1440000D */  bnez      $v0, .LIQUE_80065284
/* 40650 80065250 00000000 */   nop
/* 40654 80065254 0C01AF08 */  jal       __osViGetCurrentContext
/* 40658 80065258 00000000 */   nop
/* 4065C 8006525C 00408021 */  addu      $s0, $v0, $zero
/* 40660 80065260 8C440010 */  lw        $a0, 0x10($v0)
/* 40664 80065264 50800005 */  beql      $a0, $zero, .LIQUE_8006527C
/* 40668 80065268 96020002 */   lhu      $v0, 0x2($s0)
/* 4066C 8006526C 8E050014 */  lw        $a1, 0x14($s0)
/* 40670 80065270 0C018E28 */  jal       osSendMesg
/* 40674 80065274 00003021 */   addu     $a2, $zero, $zero
/* 40678 80065278 96020002 */  lhu       $v0, 0x2($s0)
.LIQUE_8006527C:
/* 4067C 8006527C 3C01800B */  lui       $at, %hi(retrace)
/* 40680 80065280 A422D310 */  sh        $v0, %lo(retrace)($at)
.LIQUE_80065284:
/* 40684 80065284 3C02800A */  lui       $v0, %hi(__osViIntrCount)
/* 40688 80065288 8C4291B0 */  lw        $v0, %lo(__osViIntrCount)($v0)
/* 4068C 8006528C 24420001 */  addiu     $v0, $v0, 0x1
/* 40690 80065290 3C01800A */  lui       $at, %hi(__osViIntrCount)
/* 40694 80065294 AC2291B0 */  sw        $v0, %lo(__osViIntrCount)($at)
/* 40698 80065298 1220000A */  beqz      $s1, .LIQUE_800652C4
/* 4069C 8006529C 00000000 */   nop
/* 406A0 800652A0 0C018EB8 */  jal       osGetCount
/* 406A4 800652A4 00008821 */   addu     $s1, $zero, $zero
/* 406A8 800652A8 00408021 */  addu      $s0, $v0, $zero
/* 406AC 800652AC 02002821 */  addu      $a1, $s0, $zero
/* 406B0 800652B0 00002021 */  addu      $a0, $zero, $zero
/* 406B4 800652B4 3C01800A */  lui       $at, %hi(__osCurrentTime)
/* 406B8 800652B8 AC2491D8 */  sw        $a0, %lo(__osCurrentTime)($at)
/* 406BC 800652BC 3C01800A */  lui       $at, %hi(__osCurrentTime + 4)
/* 406C0 800652C0 AC2591DC */  sw        $a1, %lo(__osCurrentTime + 4)($at)
.LIQUE_800652C4:
/* 406C4 800652C4 3C10800A */  lui       $s0, %hi(__osBaseCounter)
/* 406C8 800652C8 8E10918C */  lw        $s0, %lo(__osBaseCounter)($s0)
/* 406CC 800652CC 0C018EB8 */  jal       osGetCount
/* 406D0 800652D0 00000000 */   nop
/* 406D4 800652D4 3C01800A */  lui       $at, %hi(__osBaseCounter)
/* 406D8 800652D8 AC22918C */  sw        $v0, %lo(__osBaseCounter)($at)
/* 406DC 800652DC 00508023 */  subu      $s0, $v0, $s0
/* 406E0 800652E0 02002821 */  addu      $a1, $s0, $zero
/* 406E4 800652E4 3C02800A */  lui       $v0, %hi(__osCurrentTime)
/* 406E8 800652E8 8C4291D8 */  lw        $v0, %lo(__osCurrentTime)($v0)
/* 406EC 800652EC 3C03800A */  lui       $v1, %hi(__osCurrentTime + 4)
/* 406F0 800652F0 8C6391DC */  lw        $v1, %lo(__osCurrentTime + 4)($v1)
/* 406F4 800652F4 00002021 */  addu      $a0, $zero, $zero
/* 406F8 800652F8 00651821 */  addu      $v1, $v1, $a1
/* 406FC 800652FC 0065302B */  sltu      $a2, $v1, $a1
/* 40700 80065300 00441021 */  addu      $v0, $v0, $a0
/* 40704 80065304 00461021 */  addu      $v0, $v0, $a2
/* 40708 80065308 3C01800A */  lui       $at, %hi(__osCurrentTime)
/* 4070C 8006530C AC2291D8 */  sw        $v0, %lo(__osCurrentTime)($at)
/* 40710 80065310 3C01800A */  lui       $at, %hi(__osCurrentTime + 4)
/* 40714 80065314 AC2391DC */  sw        $v1, %lo(__osCurrentTime + 4)($at)
/* 40718 80065318 08019480 */  j         .LIQUE_80065200
/* 4071C 8006531C 27A50010 */   addiu    $a1, $sp, 0x10
.LIQUE_80065320:
/* 40720 80065320 0C01923B */  jal       __osTimerInterrupt
/* 40724 80065324 00000000 */   nop
/* 40728 80065328 08019480 */  j         .LIQUE_80065200
/* 4072C 8006532C 27A50010 */   addiu    $a1, $sp, 0x10
