.include "macro.inc"

/* assembler directives */
.set noat      /* allow manual use of $at */
.set noreorder /* don't insert nops after branches */
.set gp=64     /* allow use of 64-bit general purpose registers */

.section .text, "ax"

/* Generated by spimdisasm 1.11.1 */

glabel __osViSwapContext
/* 40A30 80065630 27BDFFD0 */  addiu     $sp, $sp, -0x30
/* 40A34 80065634 3C02A440 */  lui       $v0, (0xA4400010 >> 16)
/* 40A38 80065638 34420010 */  ori       $v0, $v0, (0xA4400010 & 0xFFFF)
/* 40A3C 8006563C AFBF002C */  sw        $ra, 0x2C($sp)
/* 40A40 80065640 AFB60028 */  sw        $s6, 0x28($sp)
/* 40A44 80065644 AFB50024 */  sw        $s5, 0x24($sp)
/* 40A48 80065648 AFB40020 */  sw        $s4, 0x20($sp)
/* 40A4C 8006564C AFB3001C */  sw        $s3, 0x1C($sp)
/* 40A50 80065650 AFB20018 */  sw        $s2, 0x18($sp)
/* 40A54 80065654 AFB10014 */  sw        $s1, 0x14($sp)
/* 40A58 80065658 AFB00010 */  sw        $s0, 0x10($sp)
/* 40A5C 8006565C 8C430000 */  lw        $v1, 0x0($v0)
/* 40A60 80065660 3C108009 */  lui       $s0, %hi(__osViNext)
/* 40A64 80065664 8E104654 */  lw        $s0, %lo(__osViNext)($s0)
/* 40A68 80065668 30720001 */  andi      $s2, $v1, 0x1
/* 40A6C 8006566C 8E040004 */  lw        $a0, 0x4($s0)
/* 40A70 80065670 0C01836C */  jal       osVirtualToPhysical
/* 40A74 80065674 8E110008 */   lw       $s1, 0x8($s0)
/* 40A78 80065678 00123880 */  sll       $a3, $s2, 2
/* 40A7C 8006567C 00F21821 */  addu      $v1, $a3, $s2
/* 40A80 80065680 00031880 */  sll       $v1, $v1, 2
/* 40A84 80065684 02231821 */  addu      $v1, $s1, $v1
/* 40A88 80065688 8C650028 */  lw        $a1, 0x28($v1)
/* 40A8C 8006568C 96040000 */  lhu       $a0, 0x0($s0)
/* 40A90 80065690 30840002 */  andi      $a0, $a0, 0x2
/* 40A94 80065694 10800008 */  beqz      $a0, .LIQUE_800656B8
/* 40A98 80065698 00455021 */   addu     $t2, $v0, $a1
/* 40A9C 8006569C 2402F000 */  addiu     $v0, $zero, -0x1000
/* 40AA0 800656A0 8E230020 */  lw        $v1, 0x20($s1)
/* 40AA4 800656A4 8E040020 */  lw        $a0, 0x20($s0)
/* 40AA8 800656A8 00621824 */  and       $v1, $v1, $v0
/* 40AAC 800656AC 00832025 */  or        $a0, $a0, $v1
/* 40AB0 800656B0 080195B0 */  j         .LIQUE_800656C0
/* 40AB4 800656B4 AE040020 */   sw       $a0, 0x20($s0)
.LIQUE_800656B8:
/* 40AB8 800656B8 8E220020 */  lw        $v0, 0x20($s1)
/* 40ABC 800656BC AE020020 */  sw        $v0, 0x20($s0)
.LIQUE_800656C0:
/* 40AC0 800656C0 96020000 */  lhu       $v0, 0x0($s0)
/* 40AC4 800656C4 30420004 */  andi      $v0, $v0, 0x4
/* 40AC8 800656C8 10400026 */  beqz      $v0, .LIQUE_80065764
/* 40ACC 800656CC 00F21821 */   addu     $v1, $a3, $s2
/* 40AD0 800656D0 00031880 */  sll       $v1, $v1, 2
/* 40AD4 800656D4 2624002C */  addiu     $a0, $s1, 0x2C
/* 40AD8 800656D8 00831821 */  addu      $v1, $a0, $v1
/* 40ADC 800656DC 8C620000 */  lw        $v0, 0x0($v1)
/* 40AE0 800656E0 30420FFF */  andi      $v0, $v0, 0xFFF
/* 40AE4 800656E4 44822000 */  mtc1      $v0, $f4
/* 40AE8 800656E8 46802121 */  cvt.d.w   $f4, $f4
/* 40AEC 800656EC 04410005 */  bgez      $v0, .LIQUE_80065704
/* 40AF0 800656F0 C6020024 */   lwc1     $f2, 0x24($s0)
/* 40AF4 800656F4 3C0141F0 */  lui       $at, (0x41F00000 >> 16)
/* 40AF8 800656F8 44810800 */  mtc1      $at, $f1
/* 40AFC 800656FC 44800000 */  mtc1      $zero, $f0
/* 40B00 80065700 46202100 */  add.d     $f4, $f4, $f0
.LIQUE_80065704:
/* 40B04 80065704 46202020 */  cvt.s.d   $f0, $f4
/* 40B08 80065708 46001002 */  mul.s     $f0, $f2, $f0
/* 40B0C 8006570C 3C014F00 */  lui       $at, (0x4F000000 >> 16)
/* 40B10 80065710 44811000 */  mtc1      $at, $f2
/* 40B14 80065714 4600103E */  c.le.s    $f2, $f0
/* 40B18 80065718 45030005 */  bc1tl     .LIQUE_80065730
/* 40B1C 8006571C 46020001 */   sub.s    $f0, $f0, $f2
/* 40B20 80065720 4600018D */  trunc.w.s $f6, $f0
/* 40B24 80065724 44053000 */  mfc1      $a1, $f6
/* 40B28 80065728 080195D1 */  j         .LIQUE_80065744
/* 40B2C 8006572C 00F21021 */   addu     $v0, $a3, $s2
.LIQUE_80065730:
/* 40B30 80065730 3C028000 */  lui       $v0, (0x80000000 >> 16)
/* 40B34 80065734 4600018D */  trunc.w.s $f6, $f0
/* 40B38 80065738 44053000 */  mfc1      $a1, $f6
/* 40B3C 8006573C 00A22825 */  or        $a1, $a1, $v0
/* 40B40 80065740 00F21021 */  addu      $v0, $a3, $s2
.LIQUE_80065744:
/* 40B44 80065744 00021080 */  sll       $v0, $v0, 2
/* 40B48 80065748 00821021 */  addu      $v0, $a0, $v0
/* 40B4C 8006574C AE05002C */  sw        $a1, 0x2C($s0)
/* 40B50 80065750 8C430000 */  lw        $v1, 0x0($v0)
/* 40B54 80065754 2404F000 */  addiu     $a0, $zero, -0x1000
/* 40B58 80065758 00641824 */  and       $v1, $v1, $a0
/* 40B5C 8006575C 080195DD */  j         .LIQUE_80065774
/* 40B60 80065760 00A31825 */   or       $v1, $a1, $v1
.LIQUE_80065764:
/* 40B64 80065764 00F21021 */  addu      $v0, $a3, $s2
/* 40B68 80065768 00021080 */  sll       $v0, $v0, 2
/* 40B6C 8006576C 02221021 */  addu      $v0, $s1, $v0
/* 40B70 80065770 8C43002C */  lw        $v1, 0x2C($v0)
.LIQUE_80065774:
/* 40B74 80065774 AE03002C */  sw        $v1, 0x2C($s0)
/* 40B78 80065778 00F21021 */  addu      $v0, $a3, $s2
/* 40B7C 8006577C 00029080 */  sll       $s2, $v0, 2
/* 40B80 80065780 02322021 */  addu      $a0, $s1, $s2
/* 40B84 80065784 8E33001C */  lw        $s3, 0x1C($s1)
/* 40B88 80065788 96060000 */  lhu       $a2, 0x0($s0)
/* 40B8C 8006578C 3C058009 */  lui       $a1, %hi(__additional_scanline)
/* 40B90 80065790 8CA532BC */  lw        $a1, %lo(__additional_scanline)($a1)
/* 40B94 80065794 8C820030 */  lw        $v0, 0x30($a0)
/* 40B98 80065798 00051C00 */  sll       $v1, $a1, 16
/* 40B9C 8006579C 00431023 */  subu      $v0, $v0, $v1
/* 40BA0 800657A0 30C40020 */  andi      $a0, $a2, 0x20
/* 40BA4 800657A4 10800002 */  beqz      $a0, .LIQUE_800657B0
/* 40BA8 800657A8 0045A021 */   addu     $s4, $v0, $a1
/* 40BAC 800657AC 00009821 */  addu      $s3, $zero, $zero
.LIQUE_800657B0:
/* 40BB0 800657B0 30C20040 */  andi      $v0, $a2, 0x40
/* 40BB4 800657B4 10400007 */  beqz      $v0, .LIQUE_800657D4
/* 40BB8 800657B8 30C20080 */   andi     $v0, $a2, 0x80
/* 40BBC 800657BC 8E040004 */  lw        $a0, 0x4($s0)
/* 40BC0 800657C0 0C01836C */  jal       osVirtualToPhysical
/* 40BC4 800657C4 AE00002C */   sw       $zero, 0x2C($s0)
/* 40BC8 800657C8 00405021 */  addu      $t2, $v0, $zero
/* 40BCC 800657CC 96060000 */  lhu       $a2, 0x0($s0)
/* 40BD0 800657D0 30C20080 */  andi      $v0, $a2, 0x80
.LIQUE_800657D4:
/* 40BD4 800657D4 10400008 */  beqz      $v0, .LIQUE_800657F8
/* 40BD8 800657D8 3C0203FF */   lui      $v0, (0x3FF0000 >> 16)
/* 40BDC 800657DC 96030028 */  lhu       $v1, 0x28($s0)
/* 40BE0 800657E0 8E040004 */  lw        $a0, 0x4($s0)
/* 40BE4 800657E4 00031C00 */  sll       $v1, $v1, 16
/* 40BE8 800657E8 00621824 */  and       $v1, $v1, $v0
/* 40BEC 800657EC 0C01836C */  jal       osVirtualToPhysical
/* 40BF0 800657F0 AE03002C */   sw       $v1, 0x2C($s0)
/* 40BF4 800657F4 00405021 */  addu      $t2, $v0, $zero
.LIQUE_800657F8:
/* 40BF8 800657F8 3C03A440 */  lui       $v1, (0xA4400004 >> 16)
/* 40BFC 800657FC 34630004 */  ori       $v1, $v1, (0xA4400004 & 0xFFFF)
/* 40C00 80065800 3C04A440 */  lui       $a0, (0xA4400008 >> 16)
/* 40C04 80065804 34840008 */  ori       $a0, $a0, (0xA4400008 & 0xFFFF)
/* 40C08 80065808 3C05A440 */  lui       $a1, (0xA4400014 >> 16)
/* 40C0C 8006580C 34A50014 */  ori       $a1, $a1, (0xA4400014 & 0xFFFF)
/* 40C10 80065810 3C06A440 */  lui       $a2, (0xA4400018 >> 16)
/* 40C14 80065814 34C60018 */  ori       $a2, $a2, (0xA4400018 & 0xFFFF)
/* 40C18 80065818 3C08A440 */  lui       $t0, (0xA440001C >> 16)
/* 40C1C 8006581C 3508001C */  ori       $t0, $t0, (0xA440001C & 0xFFFF)
/* 40C20 80065820 3C0BA440 */  lui       $t3, (0xA4400020 >> 16)
/* 40C24 80065824 356B0020 */  ori       $t3, $t3, (0xA4400020 & 0xFFFF)
/* 40C28 80065828 3C09A440 */  lui       $t1, (0xA4400024 >> 16)
/* 40C2C 8006582C 35290024 */  ori       $t1, $t1, (0xA4400024 & 0xFFFF)
/* 40C30 80065830 3C07A440 */  lui       $a3, (0xA4400028 >> 16)
/* 40C34 80065834 34E70028 */  ori       $a3, $a3, (0xA4400028 & 0xFFFF)
/* 40C38 80065838 3C0CA440 */  lui       $t4, (0xA440002C >> 16)
/* 40C3C 8006583C 358C002C */  ori       $t4, $t4, (0xA440002C & 0xFFFF)
/* 40C40 80065840 AC6A0000 */  sw        $t2, 0x0($v1)
/* 40C44 80065844 8E220008 */  lw        $v0, 0x8($s1)
/* 40C48 80065848 3C0DA440 */  lui       $t5, (0xA440000C >> 16)
/* 40C4C 8006584C AC820000 */  sw        $v0, 0x0($a0)
/* 40C50 80065850 8E23000C */  lw        $v1, 0xC($s1)
/* 40C54 80065854 35AD000C */  ori       $t5, $t5, (0xA440000C & 0xFFFF)
/* 40C58 80065858 ACA30000 */  sw        $v1, 0x0($a1)
/* 40C5C 8006585C 8E220010 */  lw        $v0, 0x10($s1)
/* 40C60 80065860 3C0AA440 */  lui       $t2, (0xA4400030 >> 16)
/* 40C64 80065864 ACC20000 */  sw        $v0, 0x0($a2)
/* 40C68 80065868 8E230014 */  lw        $v1, 0x14($s1)
/* 40C6C 8006586C 354A0030 */  ori       $t2, $t2, (0xA4400030 & 0xFFFF)
/* 40C70 80065870 AD030000 */  sw        $v1, 0x0($t0)
/* 40C74 80065874 8E220018 */  lw        $v0, 0x18($s1)
/* 40C78 80065878 3C06A440 */  lui       $a2, (0xA4400034 >> 16)
/* 40C7C 8006587C AD620000 */  sw        $v0, 0x0($t3)
/* 40C80 80065880 02321021 */  addu      $v0, $s1, $s2
/* 40C84 80065884 AD330000 */  sw        $s3, 0x0($t1)
/* 40C88 80065888 ACF40000 */  sw        $s4, 0x0($a3)
/* 40C8C 8006588C 8C430034 */  lw        $v1, 0x34($v0)
/* 40C90 80065890 34C60034 */  ori       $a2, $a2, (0xA4400034 & 0xFFFF)
/* 40C94 80065894 AD830000 */  sw        $v1, 0x0($t4)
/* 40C98 80065898 8C440038 */  lw        $a0, 0x38($v0)
/* 40C9C 8006589C 02004021 */  addu      $t0, $s0, $zero
/* 40CA0 800658A0 ADA40000 */  sw        $a0, 0x0($t5)
/* 40CA4 800658A4 8E020020 */  lw        $v0, 0x20($s0)
/* 40CA8 800658A8 3C058009 */  lui       $a1, %hi(__osViCurr)
/* 40CAC 800658AC 8CA54650 */  lw        $a1, %lo(__osViCurr)($a1)
/* 40CB0 800658B0 25090030 */  addiu     $t1, $t0, 0x30
/* 40CB4 800658B4 3C018009 */  lui       $at, %hi(__osViCurr)
/* 40CB8 800658B8 AC304650 */  sw        $s0, %lo(__osViCurr)($at)
/* 40CBC 800658BC AD420000 */  sw        $v0, 0x0($t2)
/* 40CC0 800658C0 8E04002C */  lw        $a0, 0x2C($s0)
/* 40CC4 800658C4 00A03821 */  addu      $a3, $a1, $zero
/* 40CC8 800658C8 3C018009 */  lui       $at, %hi(__osViNext)
/* 40CCC 800658CC AC254654 */  sw        $a1, %lo(__osViNext)($at)
/* 40CD0 800658D0 ACC40000 */  sw        $a0, 0x0($a2)
/* 40CD4 800658D4 8E03000C */  lw        $v1, 0xC($s0)
/* 40CD8 800658D8 3C02A440 */  lui       $v0, %hi(D_A4400000)
/* 40CDC 800658DC AC430000 */  sw        $v1, %lo(D_A4400000)($v0)
.LIQUE_800658E0:
/* 40CE0 800658E0 8D0F0000 */  lw        $t7, 0x0($t0)
/* 40CE4 800658E4 8D150004 */  lw        $s5, 0x4($t0)
/* 40CE8 800658E8 8D160008 */  lw        $s6, 0x8($t0)
/* 40CEC 800658EC 8D0E000C */  lw        $t6, 0xC($t0)
/* 40CF0 800658F0 ACEF0000 */  sw        $t7, 0x0($a3)
/* 40CF4 800658F4 ACF50004 */  sw        $s5, 0x4($a3)
/* 40CF8 800658F8 ACF60008 */  sw        $s6, 0x8($a3)
/* 40CFC 800658FC ACEE000C */  sw        $t6, 0xC($a3)
/* 40D00 80065900 25080010 */  addiu     $t0, $t0, 0x10
/* 40D04 80065904 1509FFF6 */  bne       $t0, $t1, .LIQUE_800658E0
/* 40D08 80065908 24E70010 */   addiu    $a3, $a3, 0x10
/* 40D0C 8006590C 8FBF002C */  lw        $ra, 0x2C($sp)
/* 40D10 80065910 8FB60028 */  lw        $s6, 0x28($sp)
/* 40D14 80065914 8FB50024 */  lw        $s5, 0x24($sp)
/* 40D18 80065918 8FB40020 */  lw        $s4, 0x20($sp)
/* 40D1C 8006591C 8FB3001C */  lw        $s3, 0x1C($sp)
/* 40D20 80065920 8FB20018 */  lw        $s2, 0x18($sp)
/* 40D24 80065924 8FB10014 */  lw        $s1, 0x14($sp)
/* 40D28 80065928 8FB00010 */  lw        $s0, 0x10($sp)
/* 40D2C 8006592C 03E00008 */  jr        $ra
/* 40D30 80065930 27BD0030 */   addiu    $sp, $sp, 0x30
/* 40D34 80065934 00000000 */  nop
/* 40D38 80065938 00000000 */  nop
/* 40D3C 8006593C 00000000 */  nop
